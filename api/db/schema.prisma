datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = "native"
}

model User {
  id         String    @id @unique @default(uuid()) // Prisma ID
  supabaseId String    @unique // Supabase ID
  email      String    @unique
  name       String?
  storage    Storage[]
  createdAt  DateTime // Supabase createdAt
  updatedAt  DateTime // Supabase updatedAt
}

model Storage {
  id         String          @id @unique @default(uuid())
  Provider   StorageProvider
  name       String
  user       User            @relation(fields: [userId], references: [id])
  userId     String
  credential Credential?
  createdAt  DateTime        @default(now())
  updatedAt  DateTime        @default(now())
}

model Credential {
  id          String   @id @unique @default(uuid())
  accessToken String
  storage     Storage  @relation(fields: [storageId], references: [id])
  storageId   String   @unique
  createdAt   DateTime @default(now())
  updatedAt   DateTime @default(now())

}

enum StorageProvider {
  AWS_S3
  GOOGLE_DRIVE
  MS_ONECLOUD
}
